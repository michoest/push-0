import{c as E,i as A,e as $,p as Y,a as f,h as p,d as te,l as I,f as oe,g as q,r as y,j,o as T,k as O,n as G,m as N,q as B,w as b,s as J,t as D,u as ne,v as Q,x as Z,y as ie,z as le,A as re,B as R,C as L,Q as U}from"./index.698ad303.js";import{u as ae,Q as se,a as ue}from"./store.92411f80.js";import"./axios.da9b7344.js";import"./notify.5a7070c6.js";var ce=E({name:"QPageContainer",setup(e,{slots:u}){const{proxy:{$q:i}}=q(),t=A(I,$);if(t===$)return console.error("QPageContainer needs to be child of QLayout"),$;Y(oe,!0);const o=f(()=>{const s={};return t.header.space===!0&&(s.paddingTop=`${t.header.size}px`),t.right.space===!0&&(s[`padding${i.lang.rtl===!0?"Left":"Right"}`]=`${t.right.size}px`),t.footer.space===!0&&(s.paddingBottom=`${t.footer.size}px`),t.left.space===!0&&(s[`padding${i.lang.rtl===!0?"Right":"Left"}`]=`${t.left.size}px`),s});return()=>p("div",{class:"q-page-container",style:o.value},te(u.default))}});function de(){const e=y(!j.value);return e.value===!1&&T(()=>{e.value=!0}),{isHydrated:e}}const ee=typeof ResizeObserver!="undefined",K=ee===!0?{}:{style:"display:block;position:absolute;top:0;left:0;right:0;bottom:0;height:100%;width:100%;overflow:hidden;pointer-events:none;z-index:-1;",url:"about:blank"};var W=E({name:"QResizeObserver",props:{debounce:{type:[String,Number],default:100}},emits:["resize"],setup(e,{emit:u}){let i=null,t,o={width:-1,height:-1};function s(a){a===!0||e.debounce===0||e.debounce==="0"?c():i===null&&(i=setTimeout(c,e.debounce))}function c(){if(i!==null&&(clearTimeout(i),i=null),t){const{offsetWidth:a,offsetHeight:l}=t;(a!==o.width||l!==o.height)&&(o={width:a,height:l},u("resize",o))}}const{proxy:v}=q();if(v.trigger=s,ee===!0){let a;const l=h=>{t=v.$el.parentNode,t?(a=new ResizeObserver(s),a.observe(t),c()):h!==!0&&N(()=>{l(!0)})};return T(()=>{l()}),O(()=>{i!==null&&clearTimeout(i),a!==void 0&&(a.disconnect!==void 0?a.disconnect():t&&a.unobserve(t))}),G}else{let h=function(){i!==null&&(clearTimeout(i),i=null),l!==void 0&&(l.removeEventListener!==void 0&&l.removeEventListener("resize",s,B.passive),l=void 0)},m=function(){h(),t&&t.contentDocument&&(l=t.contentDocument.defaultView,l.addEventListener("resize",s,B.passive),c())};const{isHydrated:a}=de();let l;return T(()=>{N(()=>{t=v.$el,t&&m()})}),O(h),()=>{if(a.value===!0)return p("object",{class:"q--avoid-card-border",style:K.style,tabindex:-1,type:"text/html",data:K.url,"aria-hidden":"true",onLoad:m})}}}}),fe=E({name:"QFooter",props:{modelValue:{type:Boolean,default:!0},reveal:Boolean,bordered:Boolean,elevated:Boolean,heightHint:{type:[String,Number],default:50}},emits:["reveal","focusin"],setup(e,{slots:u,emit:i}){const{proxy:{$q:t}}=q(),o=A(I,$);if(o===$)return console.error("QFooter needs to be child of QLayout"),$;const s=y(parseInt(e.heightHint,10)),c=y(!0),v=y(j.value===!0||o.isContainer.value===!0?0:window.innerHeight),a=f(()=>e.reveal===!0||o.view.value.indexOf("F")!==-1||t.platform.is.ios&&o.isContainer.value===!0),l=f(()=>o.isContainer.value===!0?o.containerHeight.value:v.value),h=f(()=>{if(e.modelValue!==!0)return 0;if(a.value===!0)return c.value===!0?s.value:0;const n=o.scroll.value.position+l.value+s.value-o.height.value;return n>0?n:0}),m=f(()=>e.modelValue!==!0||a.value===!0&&c.value!==!0),z=f(()=>e.modelValue===!0&&m.value===!0&&e.reveal===!0),g=f(()=>"q-footer q-layout__section--marginal "+(a.value===!0?"fixed":"absolute")+"-bottom"+(e.bordered===!0?" q-footer--bordered":"")+(m.value===!0?" q-footer--hidden":"")+(e.modelValue!==!0?" q-layout--prevent-focus"+(a.value!==!0?" hidden":""):"")),C=f(()=>{const n=o.rows.value.bottom,d={};return n[0]==="l"&&o.left.space===!0&&(d[t.lang.rtl===!0?"right":"left"]=`${o.left.size}px`),n[2]==="r"&&o.right.space===!0&&(d[t.lang.rtl===!0?"left":"right"]=`${o.right.size}px`),d});function w(n,d){o.update("footer",n,d)}function x(n,d){n.value!==d&&(n.value=d)}function H({height:n}){x(s,n),w("size",n)}function P(){if(e.reveal!==!0)return;const{direction:n,position:d,inflectionPoint:S}=o.scroll.value;x(c,n==="up"||d-S<100||o.height.value-l.value-d-s.value<300)}function _(n){z.value===!0&&x(c,!0),i("focusin",n)}b(()=>e.modelValue,n=>{w("space",n),x(c,!0),o.animate()}),b(h,n=>{w("offset",n)}),b(()=>e.reveal,n=>{n===!1&&x(c,e.modelValue)}),b(c,n=>{o.animate(),i("reveal",n)}),b([s,o.scroll,o.height],P),b(()=>t.screen.height,n=>{o.isContainer.value!==!0&&x(v,n)});const r={};return o.instances.footer=r,e.modelValue===!0&&w("size",s.value),w("space",e.modelValue),w("offset",h.value),O(()=>{o.instances.footer===r&&(o.instances.footer=void 0,w("size",0),w("offset",0),w("space",!1))}),()=>{const n=J(u.default,[p(W,{debounce:0,onResize:H})]);return e.elevated===!0&&n.push(p("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),p("footer",{class:g.value,style:C.value,onFocusin:_},n)}}});const ve=[Element,String],he=[null,document,document.body,document.scrollingElement,document.documentElement];function me(e,u){let i=ne(u);if(i===void 0){if(e==null)return window;i=e.closest(".scroll,.scroll-y,.overflow-auto")}return he.includes(i)?window:i}function ge(e){return e===window?window.pageYOffset||window.scrollY||document.body.scrollTop||0:e.scrollTop}function pe(e){return e===window?window.pageXOffset||window.scrollX||document.body.scrollLeft||0:e.scrollLeft}let V;function F(){if(V!==void 0)return V;const e=document.createElement("p"),u=document.createElement("div");D(e,{width:"100%",height:"200px"}),D(u,{position:"absolute",top:"0px",left:"0px",visibility:"hidden",width:"200px",height:"150px",overflow:"hidden"}),u.appendChild(e),document.body.appendChild(u);const i=e.offsetWidth;u.style.overflow="scroll";let t=e.offsetWidth;return i===t&&(t=u.clientWidth),u.remove(),V=i-t,V}const{passive:X}=B,ye=["both","horizontal","vertical"];var we=E({name:"QScrollObserver",props:{axis:{type:String,validator:e=>ye.includes(e),default:"vertical"},debounce:[String,Number],scrollTarget:ve},emits:["scroll"],setup(e,{emit:u}){const i={position:{top:0,left:0},direction:"down",directionChanged:!1,delta:{top:0,left:0},inflectionPoint:{top:0,left:0}};let t=null,o,s;b(()=>e.scrollTarget,()=>{a(),v()});function c(){t!==null&&t();const m=Math.max(0,ge(o)),z=pe(o),g={top:m-i.position.top,left:z-i.position.left};if(e.axis==="vertical"&&g.top===0||e.axis==="horizontal"&&g.left===0)return;const C=Math.abs(g.top)>=Math.abs(g.left)?g.top<0?"up":"down":g.left<0?"left":"right";i.position={top:m,left:z},i.directionChanged=i.direction!==C,i.delta=g,i.directionChanged===!0&&(i.direction=C,i.inflectionPoint=i.position),u("scroll",{...i})}function v(){o=me(s,e.scrollTarget),o.addEventListener("scroll",l,X),l(!0)}function a(){o!==void 0&&(o.removeEventListener("scroll",l,X),o=void 0)}function l(m){if(m===!0||e.debounce===0||e.debounce==="0")c();else if(t===null){const[z,g]=e.debounce?[setTimeout(c,e.debounce),clearTimeout]:[requestAnimationFrame(c),cancelAnimationFrame];t=()=>{g(z),t=null}}}const{proxy:h}=q();return b(()=>h.$q.lang.rtl,c),T(()=>{s=h.$el.parentNode,v()}),O(()=>{t!==null&&t(),a()}),Object.assign(h,{trigger:l,getPosition:()=>i}),G}}),be=E({name:"QLayout",props:{container:Boolean,view:{type:String,default:"hhh lpr fff",validator:e=>/^(h|l)h(h|r) lpr (f|l)f(f|r)$/.test(e.toLowerCase())},onScroll:Function,onScrollHeight:Function,onResize:Function},setup(e,{slots:u,emit:i}){const{proxy:{$q:t}}=q(),o=y(null),s=y(t.screen.height),c=y(e.container===!0?0:t.screen.width),v=y({position:0,direction:"down",inflectionPoint:0}),a=y(0),l=y(j.value===!0?0:F()),h=f(()=>"q-layout q-layout--"+(e.container===!0?"containerized":"standard")),m=f(()=>e.container===!1?{minHeight:t.screen.height+"px"}:null),z=f(()=>l.value!==0?{[t.lang.rtl===!0?"left":"right"]:`${l.value}px`}:null),g=f(()=>l.value!==0?{[t.lang.rtl===!0?"right":"left"]:0,[t.lang.rtl===!0?"left":"right"]:`-${l.value}px`,width:`calc(100% + ${l.value}px)`}:null);function C(r){if(e.container===!0||document.qScrollPrevented!==!0){const n={position:r.position.top,direction:r.direction,directionChanged:r.directionChanged,inflectionPoint:r.inflectionPoint.top,delta:r.delta.top};v.value=n,e.onScroll!==void 0&&i("scroll",n)}}function w(r){const{height:n,width:d}=r;let S=!1;s.value!==n&&(S=!0,s.value=n,e.onScrollHeight!==void 0&&i("scrollHeight",n),H()),c.value!==d&&(S=!0,c.value=d),S===!0&&e.onResize!==void 0&&i("resize",r)}function x({height:r}){a.value!==r&&(a.value=r,H())}function H(){if(e.container===!0){const r=s.value>a.value?F():0;l.value!==r&&(l.value=r)}}let P=null;const _={instances:{},view:f(()=>e.view),isContainer:f(()=>e.container),rootRef:o,height:s,containerHeight:a,scrollbarWidth:l,totalWidth:f(()=>c.value+l.value),rows:f(()=>{const r=e.view.toLowerCase().split(" ");return{top:r[0].split(""),middle:r[1].split(""),bottom:r[2].split("")}}),header:Q({size:0,offset:0,space:!1}),right:Q({size:300,offset:0,space:!1}),footer:Q({size:0,offset:0,space:!1}),left:Q({size:300,offset:0,space:!1}),scroll:v,animate(){P!==null?clearTimeout(P):document.body.classList.add("q-body--layout-animate"),P=setTimeout(()=>{P=null,document.body.classList.remove("q-body--layout-animate")},155)},update(r,n,d){_[r][n]=d}};if(Y(I,_),F()>0){let d=function(){r=null,n.classList.remove("hide-scrollbar")},S=function(){if(r===null){if(n.scrollHeight>t.screen.height)return;n.classList.add("hide-scrollbar")}else clearTimeout(r);r=setTimeout(d,300)},k=function(M){r!==null&&M==="remove"&&(clearTimeout(r),d()),window[`${M}EventListener`]("resize",S)},r=null;const n=document.body;b(()=>e.container!==!0?"add":"remove",k),e.container!==!0&&k("add"),Z(()=>{k("remove")})}return()=>{const r=J(u.default,[p(we,{onScroll:C}),p(W,{onResize:w})]),n=p("div",{class:h.value,style:m.value,ref:e.container===!0?void 0:o,tabindex:-1},r);return e.container===!0?p("div",{class:"q-layout-container overflow-hidden",ref:o},[p(W,{onResize:x}),p("div",{class:"absolute-full",style:z.value},[p("div",{class:"scroll",style:g.value},[n])])]):n}}});const Ce=Object.assign({name:"AppLayout"},{__name:"app.layout",setup(e){const u=ae(),i=A("notify");T(async()=>{t.value=u.persistent.api,await s(),navigator.serviceWorker.addEventListener("message",v)}),Z(()=>{navigator.serviceWorker.removeEventListener("message",v)});const t=y(""),o=y(!1),s=async()=>{o.value=await u.checkAPI(t.value)},c=()=>{u.setAPI(t.value),i("API updated!")},v=a=>{a.data&&a.data.type==="PUSH_RECEIVED"&&u.handlePush(a.data.payload)};return(a,l)=>{const h=ie("router-view");return le(),re(be,{view:"lHh Lpr lFf"},{default:R(()=>[L(ce,null,{default:R(()=>[L(h)]),_:1}),L(fe,{class:"bg-grey-2 text-primary"},{default:R(()=>[L(se),L(ue,{modelValue:t.value,"onUpdate:modelValue":l[0]||(l[0]=m=>t.value=m),placeholder:"API URL",class:"q-mx-sm"},{append:R(()=>[L(U,{round:"",dense:"",flat:"",icon:"network_check",color:o.value?"positive":"negative",onClick:s},null,8,["color"]),L(U,{round:"",dense:"",flat:"",color:"primary",icon:"sync",onClick:c})]),_:1},8,["modelValue"])]),_:1})]),_:1})}}});export{Ce as default};
